<html>
    <head>
    
    <style>
        body {
            background-image: linear-gradient(rgba(0,0,0,0.75), rgba(0,0,0,0.75)),url(/static/StocksBackground.jpg);
        }
        p {
        color: white;
        }
        h1{
        color: white;
        }
        .center{
        text-align: center;
        }
    </style>  
    <link rel="stylesheet" href="/static/style.css"> 
    </head> 
    <body>
        <div class="banner">
            <div class="navbar">
                <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
                <img src="/static/StocksLogo.png" class="logo">
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="login.html">Logout</a></li>
                    <li><a href="stats.html">Stats</a></li>
                    <li><a href="about.html">About</a></li>
                </ul>
            </div>

        <title>The Stock Guessing Game</title>
        <h1 class="center">Today's Stock: Google</h1>
        <h1 class="center" id="stockPrice"></h1>
        

        <script>
        document.addEventListener("DOMContentLoaded", function () {
        const apiKey = 'cjtnki9r01qr9581rns0cjtnki9r01qr9581rnsg';
        const symbol = 'GOOGL';
        const apiUrl = `https://finnhub.io/api/v1/quote?symbol=${symbol}&token=${apiKey}`;

        // Add this to create a variable to store stock prices
        let stockPrices = [];

        // Function to update the chart
        function updateChart() {
            const ctx = document.getElementById('stockChart').getContext('2d');

            // Use Chart.js to create a line chart
            const myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: stockPrices.map(entry => entry.time),
                    datasets: [{
                        label: 'Stock Price',
                        data: stockPrices.map(entry => entry.price),
                        borderColor: 'rgba(75, 192, 192, 1)',
                        pointBackgroundColor: 'rgba(0,0,255,1)',
                        borderWidth: 1,
                        fill: false,
                    }]
                },
            });
        }

        function fetchData() {
            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    const stockPrice = data.c;
                    const currentTime = new Date().toLocaleTimeString();

                    // Add the new stock price entry to the array
                    stockPrices.push({ time: currentTime, price: stockPrice });

                    // Update the chart
                    updateChart();
                })
                .catch(error => console.error('Error fetching stock price:', error));
        }

        // Fetch data every 5 seconds
        setInterval(fetchData, 100);
    });

          document.addEventListener("DOMContentLoaded", function() {
              const apiKey = 'cjtnki9r01qr9581rns0cjtnki9r01qr9581rnsg';
              const symboql = 'GOOGL'; // Google's stock symbol on Finnhub  
              const apiUrl = `https://finnhub.io/api/v1/quote?symbol=${symbol}&token=${apiKey}`;
          
              fetch(apiUrl)
                  .then(response => response.json())
                  .then(data => {
                      const stockPrice = data.c; // 'c' represents the current price in the Finnhub API response
                      document.getElementById('stockPrice').innerText = `Current Price: $${stockPrice}`;
                  })
                  .catch(error => console.error('Error fetching stock price:', error));
          });
          </script>

<br><br>
<h1 class="center">Your Location</h1>
<p class='center'>{{data.location}}</p>
<br><br>
<h1 class="center">Your Guess Today</h1>
<p class='center'>{{data.guesstoday}}</p>
<br><br>
<h1 class="center">Your Streak</h1>
<p class='center'>{{data.streak}}</p>
<br><br>    
<h1 class="center">Here is the AI Prediction: </h1>
<p class='center'>THE STOCK WILL GO UP</p>
<br><br>

<h1 class="center">AI Streak: </h1>
<p class='center'>5</p>
<canvas id="stockChart" color="white" class="center" width="1000" height="500"></canvas>
</body>
</html>